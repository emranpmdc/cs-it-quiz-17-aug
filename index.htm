<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SST Tests Preparation</title>
    <!-- Use Tailwind CSS for modern, responsive styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Include html2canvas for capturing the result as a PNG -->
    <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
    <style>
        /* Define a custom font family for Georgia */
        .font-georgia {
            font-family: Georgia, serif;
        }

        /* Style for the custom modal box */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.75);
            backdrop-filter: blur(5px);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 100;
            opacity: 0;
            transition: opacity 0.3s ease-in-out;
        }

        .modal-overlay.active {
            opacity: 1;
        }

        .modal-content {
            background-color: #ffffff;
            padding: 2.5rem;
            border-radius: 1rem;
            text-align: center;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.3);
            transform: translateY(-50px);
            opacity: 0;
            transition: all 0.3s ease-in-out;
        }
        
        .modal-overlay.active .modal-content {
            transform: translateY(0);
            opacity: 1;
        }

        /* Button Gradient for Submit */
        .submit-btn {
            background-image: linear-gradient(to right, #10b981, #059669);
            transition: all 0.3s ease;
        }
        .submit-btn:hover {
            box-shadow: 0 4px 15px rgba(5, 150, 105, 0.4);
        }

        /* Option Hover and Selected Effect with new dark green color and no zoom */
        .quiz-option-label {
            transition: all 0.3s ease-in-out;
        }
        
        /* Change background on hover */
        .quiz-option-label:hover {
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            background-color: #059669; /* Dark green background */
        }
        
        /* Change text color to white on hover */
        .quiz-option-label:hover span {
            color: #ffffff;
        }
        
        /* Selected option styling - Shadow removed here */
        .quiz-option-label.selected {
            background-color: #059669; /* Dark green background */
            /* Removed box-shadow here: box-shadow: 0 44px 15px rgba(0, 0, 0, 0.2); */
        }
        
        /* Ensures text inside selected option is white */
        .quiz-option-label.selected span {
            color: #ffffff;
        }
        
        /* Hide the default radio button while keeping it functional */
        .quiz-option-label input[type="radio"] {
            display: none;
        }
        
        /* Adjust main layout to ensure all components fit on screen */
        .main-container {
            display: flex;
            flex-direction: column;
            justify-content: center;
            flex-grow: 1; /* Allows the container to fill available space */
            padding-top: 1rem;
            padding-bottom: 1rem;
        }

        /* On smaller screens, adjust padding to prevent content overflow */
        @media (max-width: 640px) {
            .quiz-content-wrapper {
                padding: 1rem;
            }
        }
        
        /* No zoom effect on buttons */
        .no-zoom:hover {
            transform: none !important;
        }
        
        /* Style for the temporary div used for image generation */
        #download-result-container {
            position: absolute;
            top: -9999px; /* Hide off-screen */
            left: -9999px;
            width: 800px; /* A fixed width for consistent image output */
            background-color: white;
            padding: 2rem;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        #download-result-container .header-clone,
        #download-result-container .footer-clone {
            text-align: center;
            padding: 1rem;
            background-color: #10b981;
            color: white;
        }
        #download-result-container .results-clone {
            padding: 2rem;
            text-align: center;
        }
        #download-result-container .results-clone p,
        #download-result-container .results-clone h2 {
            text-align: center;
        }
        #download-result-container .results-clone .mb-3 {
            margin-bottom: 0.75rem;
        }
        #download-result-container .results-clone .mb-6 {
            margin-bottom: 1.5rem;
        }

        /* New styling for the full quiz review section */
        .quiz-review-item {
            border: 1px solid #e5e7eb;
            border-radius: 0.5rem;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            background-color: #fafafa;
        }

        .quiz-review-question {
            font-weight: 700;
            color: #FF0000; /* Bright red */
            margin-bottom: 0.75rem;
            font-size: 1.125rem; /* text-lg */
        }

        .quiz-review-option {
            padding: 0.5rem;
            border-radius: 0.375rem;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .quiz-review-option.correct {
            background-color: #dcfce7; /* green-100 */
            color: #065f46; /* green-800 */
            font-weight: 600;
        }
        .quiz-review-option.incorrect {
            background-color: #fee2e2; /* red-100 */
            color: #991b1b; /* red-800 */
        }
        
        /* --- FIX: Updated the media print query to correctly display the results container --- */
        @media print {
            /* Hide the main header and footer, as well as the button container */
            .no-print,
            #name-entry-container,
            #quiz-content-wrapper {
                display: none !important;
            }
            
            /* Ensure the main container holding the results is fully visible and styled for printing */
            .container {
                box-shadow: none !important;
                border: none !important;
                padding: 0 !important;
                margin: 0 !important;
                width: auto !important;
                max-width: none !important;
                height: auto !important;
            }

            /* Ensure the results container itself is visible and formatted for a clean printout */
            #results-container {
                display: block !important;
                box-shadow: none !important;
                border: none !important;
                padding: 0 !important;
                margin: 0 !important;
                background-color: #ffffff !important;
            }
        }

        /* Custom CSS for the video container to maintain a 16:9 aspect ratio */
        .video-container {
            position: relative;
            padding-bottom: 56.25%; /* 16:9 aspect ratio */
            height: 0;
            overflow: hidden;
            max-width: 100%;
            background: #000;
            border-radius: 1rem;
        }

        .video-container iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }

        /* Styling for the question number circle */
        .question-number-circle {
            display: inline-flex;
            justify-content: center;
            align-items: center;
            width: 30px; /* Adjust size as needed */
            height: 30px; /* Adjust size as needed */
            border-radius: 50%;
            background-color: #059669; /* Green color */
            color: #ffffff; /* White text */
            font-weight: bold;
            margin-right: 10px;
            flex-shrink: 0; /* Prevent shrinking */
        }
    </style>
</head>
<body class="bg-gradient-to-br from-emerald-50 to-green-100 min-h-screen flex flex-col justify-between items-center">

    <!-- Stylized Green Header Label with user info -->
    <div id="header" class="no-print w-full bg-gradient-to-r from-green-700 to-emerald-600 text-white text-center py-5 text-4xl font-extrabold rounded-b-3xl">
        SSTs Test Preparation 2025
        <h3 class="text-xl font-semibold mt-2">By Imran Ustad</h3>
        <p class="text-base">WhatsApp: 03345501369</p>
        <p class="text-base mt-1">
            <a href="https://www.youtube.com/@TheImranUstad" target="_blank" rel="noopener noreferrer" class="text-white hover:text-gray-200 transition-colors">
                https://www.youtube.com/@TheImranUstad
            </a>
        </p>
    </div>

    <!-- Main quiz container with enhanced styling -->
    <div class="container max-w-5xl mx-auto rounded-3xl shadow-2xl bg-white p-8 sm:p-12 my-8 flex-1 flex flex-col justify-center items-center">
        
        <!-- Name entry container (initial screen) -->
        <div id="name-entry-container" class="w-full max-w-md text-center p-8 bg-gray-50 rounded-3xl shadow-inner border-t-4 border-green-500">
            <h2 class="text-3xl font-extrabold text-green-700 mb-6">Welcome to the Quiz!</h2>
            <p class="text-lg text-gray-700 mb-4">Please enter your name to begin.</p>
            <input type="text" id="name-input" placeholder="Enter your name" class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:outline-none focus:ring-2 focus:ring-green-500 mb-6 text-center text-lg">
            <button id="start-btn" class="w-full text-white font-bold py-3.5 rounded-full shadow-lg transition-colors bg-blue-600 hover:bg-blue-700 no-zoom">
                Start Quiz
            </button>
        </div>
        
        <!-- Quiz content wrapper (initially hidden) -->
        <div id="quiz-content-wrapper" class="hidden w-full">
            <!-- Controls and Timer section (Reversed for right alignment) -->
            <div class="flex flex-col sm:flex-row justify-between items-center mb-6 gap-4">
                <!-- This div is for navigation buttons (currently empty) -->
                <div class="flex gap-4">
                    <!-- Navigation buttons will be dynamically shown here -->
                </div>
                <!-- Timer is now on the right -->
                <div class="flex items-center space-x-3">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-red-600" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd" />
                    </svg>
                    <span class="text-xl font-semibold text-gray-700">Time Left:</span>
                    <span id="timer" class="text-3xl font-bold text-red-600 bg-red-100 px-5 py-2.5 rounded-xl shadow-inner">60:00</span>
                </div>
            </div>

            <!-- Quiz questions container -->
            <div id="quiz-form" class="space-y-4">
                <!-- Questions and navigation buttons will be dynamically inserted here by JavaScript -->
            </div>
        </div>

        <!-- Results container (initially hidden) -->
        <div id="results-container" class="hidden mt-8 p-8 bg-gray-50 rounded-3xl shadow-inner border-t-4 border-green-500 w-full">
            <h2 class="text-2xl sm:text-3xl font-extrabold text-center mb-4 text-green-700">Quiz Results</h2>
            <p class="text-lg mb-3 text-center">
                <span id="user-name-result" class="font-extrabold text-green-600"></span>
            </p>
            <p class="text-lg mb-3">
                Total Questions: <span id="total-questions" class="font-extrabold text-green-600"></span>
            </p>
            <p class="text-lg mb-6">
                Obtained Marks: <span id="obtained-marks" class="font-extrabold text-green-600"></span>
            </p>

            <!-- Video Container - Moved to appear on the results page -->
            <div class="w-full mx-auto my-8">
                <div class="bg-white p-6 rounded-3xl shadow-2xl">
                    <h3 class="text-xl sm:text-2xl font-extrabold text-center mb-6 text-green-700">Preparation Guide: KPPSC SST Syllabus 2025</h3>
                    <div class="video-container">
                        <iframe width="695" height="391" src="https://www.youtube.com/embed/sFzdY39_Kw8" title="KPPSC SST Syllabus 2025 KPK | SST General, Maths-Physics, Bio-Chem | Past Papers &amp; Preparation Guide" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
                    </div>
                </div>
            </div>

            <div id="full-quiz-review" class="mt-8">
                <h3 class="text-xl font-bold text-gray-700 mb-4">Quiz Review:</h3>
                <!-- The full quiz review will be displayed here -->
            </div>
            
            <!-- Button container for the new download button and the print button -->
            <div class="no-print flex flex-col sm:flex-row space-y-4 sm:space-y-0 sm:space-x-4 mt-8">
                <!-- Download button for results as PNG -->
                <button id="download-btn" class="w-full bg-indigo-600 text-white font-bold py-3.5 rounded-full shadow-md hover:bg-indigo-700 transition-colors no-zoom">
                    Download Result Card (PNG)
                </button>
                <!-- Print Result button -->
                <button id="print-btn" class="w-full bg-blue-600 text-white font-bold py-3.5 rounded-full shadow-md hover:bg-blue-700 transition-colors no-zoom">
                    Print Result
                </button>
            </div>
        </div>

    </div>

    <!-- Custom modal for validation/errors -->
    <div id="validation-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <p id="modal-message" class="text-xl font-semibold mb-6 text-gray-800"></p>
            <button id="modal-close-btn" class="bg-red-500 text-white font-bold py-2.5 px-6 rounded-full hover:bg-red-600 transition-colors no-zoom">
                Close
            </button>
        </div>
    </div>
    
    <!-- Updated Green Footer Label with enhanced styling -->
    <footer id="footer" class="no-print w-full bg-gradient-to-r from-green-700 to-emerald-600 text-white text-center py-6 text-2xl font-semibold rounded-t-3xl">
        <h3 class="text-2xl font-extrabold mb-1">By Imran Ustad</h3>
        <p class="text-base mb-1">WhatsApp: 03345501369</p>
        <p class="text-base">
            <a href="https://www.youtube.com/@TheImranUstad" target="_blank" rel="noopener noreferrer" class="text-white hover:text-gray-200 transition-colors">
                https://www.youtube.com/@TheImranUstad
            </a>
        </p>
    </footer>

    <script>
        // Array of 60 MCQs on Computer topics (Bachelor Level)
        const allQuestions = [
            // Software and Hardware (10 MCQs)
            { question: "1. Which component represents the physical parts of a computer system?", options: ["A. Software", "B. Hardware", "C. Firmware", "D. Middleware"], correct: 1 },
            { question: "2. Which component refers to the set of instructions that tells the hardware what to do?", options: ["A. Hardware", "B. Peripheral", "C. Software", "D. Device driver"], correct: 2 },
            { question: "3. Which of the following is an example of hardware?", options: ["A. Microsoft Word", "B. Web Browser", "C. Operating System", "D. RAM module"], correct: 3 },
            { question: "4. Which of the following is an example of software?", options: ["A. Monitor", "B. Keyboard", "C. Adobe Photoshop", "D. CPU"], correct: 2 },
            { question: "5. The interaction between hardware and software is facilitated by:", options: ["A. Only hardware", "B. Only software", "C. Both working together", "D. External network"], correct: 2 },
            { question: "6. Firmware is a type of software permanently stored in hardware devices, providing low-level control. What is its common characteristic?", options: ["A. It is frequently updated by users", "B. It is designed for general purpose computing", "C. It is typically non-volatile and rarely changed", "D. It requires extensive programming knowledge to use"], correct: 2 },
            { question: "7. Which term describes programs that manage computer hardware and software resources and provide common services for computer programs?", options: ["A. Application Software", "B. System Software", "C. Utility Software", "D. Programming Software"], correct: 1 },
            { question: "8. Device drivers are specialized software that enables an operating system to interact with specific hardware devices. What is their primary function?", options: ["A. To process user data", "B. To manage network connections", "C. To translate commands between the OS and hardware", "D. To provide a graphical user interface"], correct: 2 },
            { question: "9. The central processing unit (CPU) is a hardware component. What is its main role?", options: ["A. Storing large amounts of data", "B. Displaying visual output", "C. Executing program instructions and performing calculations", "D. Connecting to the internet"], correct: 2 },
            { question: "10. In the context of a computer system, a 'bug' typically refers to an error in:", options: ["A. Hardware components", "B. The power supply", "C. Software code", "D. Network cables"], correct: 2 },

            // Types of Software (10 MCQs)
            { question: "11. Software designed to perform specific tasks for the user is known as:", options: ["A. System software", "B. Utility software", "C. Application software", "D. Programming software"], correct: 2 },
            { question: "12. Microsoft Word, Google Chrome, and Adobe Photoshop are examples of what type of software?", options: ["A. System software", "B. Application software", "C. Network software", "D. Security software"], correct: 1 },
            { question: "13. Software that helps manage, maintain, and control computer resources is categorized as:", options: ["A. Application software", "B. Utility software", "C. Productivity software", "D. Multimedia software"], correct: 1 },
            { question: "14. Disk defragmenters, antivirus programs, and backup utilities fall under which software category?", options: ["A. System software", "B. Application software", "C. Utility software", "D. Programming languages"], correct: 2 },
            { question: "15. Software used to develop, debug, and maintain other software applications is known as:", options: ["A. Word processors", "B. Database management systems", "C. Programming software", "D. Spreadsheet applications"], correct: 2 },
            { question: "16. Which of the following is a type of system software?", options: ["A. Web browser", "B. Video player", "C. Operating system", "D. Email client"], correct: 2 },
            { question: "17. Open-source software is characterized by:", options: ["A. Being free of charge only", "B. Its source code being publicly available for modification", "C. Being developed by a single company", "D. Only running on specific hardware"], correct: 1 },
            { question: "18. Proprietary software typically means:", options: ["A. It's always free to use", "B. Its source code is open for public modification", "C. It's owned by an individual or company, and its use is restricted by licenses", "D. It is developed by a non-profit organization"], correct: 2 },
            { question: "19. Which category of software allows users to interact with and analyze large collections of data?", options: ["A. Word Processing Software", "B. Spreadsheet Software", "C. Database Management Systems (DBMS)", "D. Presentation Software"], correct: 2 },
            { question: "20. Enterprise Resource Planning (ERP) systems and Customer Relationship Management (CRM) systems are examples of:", options: ["A. Personal Productivity Tools", "B. System Utilities", "C. Enterprise Application Software", "D. Programming Languages"], correct: 2 },

            // CPU (20 MCQs)
            { question: "21. What does CPU stand for?", options: ["A. Central Power Unit", "B. Central Processing Unit", "C. Computer Personal Unit", "D. Core Processing Utility"], correct: 1 },
            { question: "22. The CPU is often referred to as the 'brain' of the computer because it:", options: ["A. Stores all data permanently", "B. Performs all arithmetic and logical operations", "C. Connects all external devices", "D. Generates visual output"], correct: 1 },
            { question: "23. Which component of the CPU performs arithmetic operations (addition, subtraction) and logical operations (AND, OR, NOT)?", options: ["A. Control Unit (CU)", "B. Registers", "C. Arithmetic Logic Unit (ALU)", "D. Cache Memory"], correct: 2 },
            { question: "24. The component of the CPU responsible for managing and coordinating all operations within the computer system is the:", options: ["A. ALU", "B. Registers", "C. Control Unit (CU)", "D. System Bus"], correct: 2 },
            { question: "25. Small, high-speed storage locations within the CPU, used to hold data and instructions temporarily during processing, are called:", options: ["A. RAM", "B. ROM", "C. Cache memory", "D. Registers"], correct: 3 },
            { question: "26. The clock speed of a CPU is measured in:", options: ["A. Bytes", "B. Gigabytes", "C. Hertz (Hz)", "D. Volts"], correct: 2 },
            { question: "27. A higher clock speed generally indicates:", options: ["A. Less power consumption", "B. Slower processing", "C. Faster processing", "D. More storage capacity"], correct: 2 },
            { question: "28. What is the purpose of 'cores' in a modern CPU?", options: ["A. To increase physical size", "B. To allow the CPU to execute multiple instructions simultaneously", "C. To reduce power consumption", "D. To store more data"], correct: 1 },
            { question: "29. Multi-threading is a CPU feature that allows a single CPU core to handle multiple processes or threads concurrently. What is its benefit?", options: ["A. Decreased performance", "B. Improved energy efficiency", "C. Enhanced multitasking and responsiveness", "D. Increased heat generation"], correct: 2 },
            { question: "30. The instruction set architecture (ISA) of a CPU defines the types of instructions a CPU can understand and execute. What is a common ISA?", options: ["A. HTML", "B. CSS", "C. x86", "D. USB"], correct: 2 },
            { question: "31. Overclocking a CPU means:", options: ["A. Running it at its default speed", "B. Reducing its clock speed to save power", "C. Running it at a higher speed than specified by the manufacturer", "D. Replacing it with a newer model"], correct: 2 },
            { question: "32. The process where the CPU fetches an instruction from memory, decodes it, executes it, and then stores the result is part of the:", options: ["A. Input/Output cycle", "B. Memory cycle", "C. Instruction cycle", "D. Boot process"], correct: 2 },
            { question: "33. Which type of cache memory is typically the fastest and closest to the CPU core?", options: ["A. L3 Cache", "B. L2 Cache", "C. L1 Cache", "D. Main Memory (RAM)"], correct: 2 },
            { question: "34. Pipelining is a technique used in CPU design to:", options: ["A. Slow down instruction execution", "B. Allow multiple instructions to be in different stages of execution simultaneously", "C. Reduce the number of cores", "D. Increase memory storage"], correct: 1 },
            { question: "35. Hyper-threading, a technology developed by Intel, allows a single physical CPU core to function as two logical cores. What is its impact?", options: ["A. It halves the CPU's performance", "B. It enables more efficient use of CPU resources for certain workloads", "C. It completely eliminates the need for multiple physical cores", "D. It reduces the CPU's clock speed"], correct: 1 },
            { question: "36. The front-side bus (FSB) was historically used to connect the CPU to what other component?", options: ["A. Hard drive", "B. Monitor", "C. Northbridge chipset (memory controller hub)", "D. Keyboard"], correct: 2 },
            { question: "37. What is the primary function of a CPU socket on the motherboard?", options: ["A. To provide power to the entire system", "B. To connect peripheral devices", "C. To physically hold the CPU and connect it to the motherboard's circuitry", "D. To install expansion cards"], correct: 2 },
            { question: "38. Thermal Design Power (TDP) for a CPU indicates:", options: ["A. Its maximum operating temperature", "B. The maximum heat generated by the CPU that the cooling system is designed to dissipate", "C. The power consumed by the entire computer system", "D. The maximum voltage it can handle"], correct: 1 },
            { question: "39. Integrated Graphics Processing Units (GPUs) are often included directly on the CPU die. What is their advantage?", options: ["A. They are always more powerful than dedicated GPUs", "B. They require more power", "C. They reduce overall system cost and power consumption for basic graphics needs", "D. They have separate video memory"], correct: 2 },
            { question: "40. What is 'microcode' in the context of a CPU?", options: ["A. A small electrical current", "B. A tiny software layer within the CPU that interprets complex instructions into simpler operations", "C. A very small physical chip", "D. A type of external storage"], correct: 1 },

            // Operating Systems and its types (20 MCQs)
            { question: "41. What is the primary role of an Operating System (OS)?", options: ["A. To create documents", "B. To manage computer hardware and software resources", "C. To browse the internet", "D. To play games"], correct: 1 },
            { question: "42. Which of the following is NOT a function of an operating system?", options: ["A. Memory management", "B. Process management", "C. User authentication", "D. Circuit design"], correct: 3 },
            { question: "43. What is a GUI in the context of an OS?", options: ["A. General User Interaction", "B. Graphical User Interface", "C. Grand Unified Input", "D. Global Utility Integration"], correct: 1 },
            { question: "44. Which type of operating system allows multiple users to access a computer system simultaneously?", options: ["A. Single-user OS", "B. Multitasking OS", "C. Multi-user OS", "D. Embedded OS"], correct: 2 },
            { question: "45. An operating system that allows a single user to run multiple programs at the same time is called a:", options: ["A. Single-user, single-tasking OS", "B. Multi-user OS", "C. Single-user, multitasking OS", "D. Real-time OS"], correct: 2 },
            { question: "46. Which type of operating system is designed to perform specific tasks within a strict time constraint, often used in industrial control systems?", options: ["A. Batch OS", "B. Distributed OS", "C. Real-time OS (RTOS)", "D. Network OS"], correct: 2 },
            { question: "47. macOS, Windows, and Linux are examples of what type of operating system?", options: ["A. Embedded operating systems", "B. Mobile operating systems", "C. Desktop operating systems", "D. Network operating systems"], correct: 2 },
            { question: "48. An operating system that manages a network and allows multiple computers to share resources is known as a:", options: ["A. Distributed OS", "B. Embedded OS", "C. Network Operating System (NOS)", "D. Real-time OS"], correct: 2 },
            { question: "49. Which component of an operating system manages the allocation and deallocation of memory space to various programs?", options: ["A. File Manager", "B. Process Scheduler", "C. Memory Manager", "D. Device Manager"], correct: 2 },
            { question: "50. What is a 'kernel' in an operating system?", options: ["A. The graphical user interface", "B. The core component of the OS that manages system resources and facilitates communication between hardware and software", "C. An application program", "D. A type of file system"], correct: 1 },
            { question: "51. Which of the following is a mobile operating system?", options: ["A. Windows 10", "B. Ubuntu", "C. Android", "D. Fedora"], correct: 2 },
            { question: "52. What is 'bootstrapping' in the context of an operating system?", options: ["A. Installing new software", "B. The process of starting up a computer and loading the operating system", "C. Shutting down the computer", "D. Connecting to the internet"], correct: 1 },
            { question: "53. A command-line interface (CLI) in an operating system primarily uses:", options: ["A. Graphical icons", "B. Text commands", "C. Touch gestures", "D. Voice commands"], correct: 1 },
            { question: "54. Which type of operating system spreads the computation over multiple physical processors/machines?", options: ["A. Single-user OS", "B. Embedded OS", "C. Distributed Operating System", "D. Batch Operating System"], correct: 2 },
            { question: "55. The primary advantage of a GUI over a CLI is:", options: ["A. It is faster for experienced users", "B. It requires less memory", "C. It is more user-friendly and intuitive for most users", "D. It allows for complex scripting"], correct: 2 },
            { question: "56. Which operating system concept involves dividing the CPU's time among multiple processes to give the illusion of simultaneous execution?", options: ["A. Multiprocessing", "B. Time-sharing", "C. Batch processing", "D. Spooling"], correct: 1 },
            { question: "57. What is 'paging' in memory management?", options: ["A. Storing all programs in one continuous block", "B. Dividing memory into fixed-size blocks (pages) to facilitate virtual memory", "C. Directly accessing physical memory addresses", "D. Compressing data to save space"], correct: 1 },
            { question: "58. Device management in an OS involves:", options: ["A. Writing application programs", "B. Handling I/O operations and allocating devices to processes", "C. Managing user accounts only", "D. Networking protocols"], correct: 1 },
            { question: "59. Which type of operating system processes jobs in batches without direct user interaction?", options: ["A. Real-time OS", "B. Network OS", "C. Batch Operating System", "D. Interactive OS"], correct: 2 },
            { question: "60. The process of moving data between RAM and the hard disk to compensate for limited RAM is called:", options: ["A. Buffering", "B. Spooling", "C. Virtual memory", "D. Caching"], correct: 2 }
        ];

        let userAnswers = {};
        let currentQuestionIndex = 0;
        let timerSeconds = 60 * 60; // 60 minutes for 60 questions
        let timerInterval;
        let userName = '';

        const nameEntryContainer = document.getElementById('name-entry-container');
        const quizContentWrapper = document.getElementById('quiz-content-wrapper');
        const nameInput = document.getElementById('name-input');
        const startBtn = document.getElementById('start-btn');
        const quizForm = document.getElementById('quiz-form');
        const resultsContainer = document.getElementById('results-container');
        const timerDisplay = document.getElementById('timer');
        const modal = document.getElementById('validation-modal');
        const modalMessage = document.getElementById('modal-message');
        const modalCloseBtn = document.getElementById('modal-close-btn');
        const printBtn = document.getElementById('print-btn');
        const downloadBtn = document.getElementById('download-btn');
        const userNameResult = document.getElementById('user-name-result');
        const fullQuizReview = document.getElementById('full-quiz-review');

        // Function to render a single question on the page
        function renderQuestion(index) {
            quizForm.innerHTML = ''; // Clear previous questions
            const q = allQuestions[index];

            const questionBox = document.createElement('div');
            questionBox.className = 'bg-slate-100 p-6 rounded-2xl shadow-lg mb-6';
            
            const questionText = document.createElement('p');
            // Apply bright red color directly via class
            questionText.className = 'text-lg sm:text-xl font-bold font-georgia text-[#FF0000] mb-4 flex items-center'; 
            
            const questionNumberSpan = document.createElement('span');
            questionNumberSpan.className = 'question-number-circle';
            questionNumberSpan.textContent = (index + 1);
            questionText.appendChild(questionNumberSpan);
            
            const questionContentSpan = document.createElement('span');
            // Get clean text content from the question string (strip leading number and dot)
            questionContentSpan.textContent = q.question.replace(/^\d+\.\s*/, ''); 
            questionText.appendChild(questionContentSpan);

            questionBox.appendChild(questionText);

            q.options.forEach((option, optionIndex) => {
                const label = document.createElement('label');
                label.className = 'quiz-option-label relative flex items-center p-4 mb-3 rounded-xl bg-white border border-gray-200 cursor-pointer transition-all duration-300 ease-in-out';
                
                const input = document.createElement('input');
                input.type = 'radio';
                input.name = `question-${index}`;
                input.value = optionIndex;
                
                const optionSpan = document.createElement('span');
                optionSpan.className = 'ml-3 text-base sm:text-lg text-gray-800 font-medium';
                // Options are already plain text, no need to strip HTML
                optionSpan.textContent = option; 
                
                label.appendChild(input);
                label.appendChild(optionSpan);
                questionBox.appendChild(label);
            });

            // Add navigation buttons to the question box
            const navButtonsDiv = document.createElement('div');
            navButtonsDiv.className = 'flex justify-between mt-6 space-x-4';
            
            // Previous Button
            const prevBtn = document.createElement('button');
            prevBtn.id = 'prev-btn';
            prevBtn.textContent = 'Previous';
            prevBtn.className = 'w-full text-white font-bold py-3.5 rounded-full shadow-lg transition-colors bg-gray-500 hover:bg-gray-600 no-zoom';
            prevBtn.addEventListener('click', previousQuestion);

            // Hide the previous button on the first question
            if (currentQuestionIndex === 0) {
                prevBtn.classList.add('hidden');
            }

            // Next/Submit Button
            let nextBtn;
            if (currentQuestionIndex === allQuestions.length - 1) {
                nextBtn = document.createElement('button');
                nextBtn.id = 'submit-btn';
                nextBtn.textContent = 'Submit Quiz';
                nextBtn.className = 'w-full text-white font-bold py-3.5 rounded-full shadow-lg transition-colors submit-btn no-zoom';
                nextBtn.addEventListener('click', submitQuiz);
            } else {
                nextBtn = document.createElement('button');
                nextBtn.id = 'next-btn';
                nextBtn.textContent = 'Next';
                nextBtn.className = 'w-full text-white font-bold py-3.5 rounded-full shadow-lg transition-colors bg-blue-600 hover:bg-blue-700 no-zoom';
                nextBtn.addEventListener('click', nextQuestion);
            }
            
            navButtonsDiv.appendChild(prevBtn);
            navButtonsDiv.appendChild(nextBtn);
            questionBox.appendChild(navButtonsDiv);
            
            quizForm.appendChild(questionBox);
            
            // Highlight the previously selected answer if it exists
            if (userAnswers[index] !== undefined) {
                const selectedLabel = quizForm.querySelector(`input[name="question-${index}"][value="${userAnswers[index]}"]`).closest('label');
                if (selectedLabel) {
                    selectedLabel.classList.add('selected');
                    selectedLabel.querySelector('input').checked = true; // Set the radio button as checked
                }
            }

            // Add event listeners for new radio buttons
            const radioButtons = quizForm.querySelectorAll('input[type="radio"]');
            radioButtons.forEach(radio => {
                radio.addEventListener('change', (event) => {
                    const parentLabel = event.target.closest('label');
                    const questionBox = parentLabel.closest('div');
                    
                    // Remove 'selected' class from all other labels in the same question
                    questionBox.querySelectorAll('label').forEach(label => {
                        label.classList.remove('selected');
                    });
                    
                    // Add 'selected' class to the currently chosen label
                    parentLabel.classList.add('selected');
                });
            });
        }
        
        // Function to start the countdown timer
        function startTimer() {
            timerInterval = setInterval(() => {
                timerSeconds--;
                const minutes = Math.floor(timerSeconds / 60);
                const seconds = timerSeconds % 60;
                timerDisplay.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                
                if (timerSeconds <= 0) {
                    clearInterval(timerInterval);
                    timerDisplay.textContent = "Time's up!";
                    submitQuiz();
                }
            }, 1000);
        }

        // Function to show the custom validation modal
        function showModal(message) {
            modalMessage.textContent = message;
            modal.classList.add('active');
            modal.classList.remove('hidden');
        }

        // Function to move to the next question
        function nextQuestion() {
            const selected = document.querySelector(`input[name="question-${currentQuestionIndex}"]:checked`);
            if (!selected) {
                showModal("Please select an option before moving to the next question.");
                return;
            }
            userAnswers[currentQuestionIndex] = parseInt(selected.value);
            
            currentQuestionIndex++;
            if (currentQuestionIndex < allQuestions.length) {
                renderQuestion(currentQuestionIndex);
            }
        }
        
        // Function to move to the previous question
        function previousQuestion() {
            // Save the current answer before moving back
            const selected = document.querySelector(`input[name="question-${currentQuestionIndex}"]:checked`);
            if (selected) {
                userAnswers[currentQuestionIndex] = parseInt(selected.value);
            }
            
            currentQuestionIndex--;
            if (currentQuestionIndex >= 0) {
                renderQuestion(currentQuestionIndex);
            }
        }
        
        // New function to start the quiz after name entry
        function startQuiz() {
            const name = nameInput.value.trim();
            if (!name) {
                showModal("Please enter your name to start the quiz.");
                return;
            }
            userName = name;
            nameEntryContainer.classList.add('hidden');
            quizContentWrapper.classList.remove('hidden');
            renderQuestion(currentQuestionIndex);
            startTimer();
        }

        // Function to render the full quiz results with correct and incorrect answers highlighted
        function renderFullResults() {
            fullQuizReview.innerHTML = ''; // Clear previous review
            
            allQuestions.forEach((q, index) => {
                const questionReviewItem = document.createElement('div');
                questionReviewItem.className = 'quiz-review-item';
                
                const questionText = document.createElement('p');
                // Use the quiz-review-question class to apply bright red color
                questionText.className = 'quiz-review-question';
                // Get clean text content from the question string (strip leading number and dot)
                questionText.innerHTML = `<span class="question-number-circle">${index + 1}</span> ${q.question.replace(/^\d+\.\s*/, '')}`;
                questionReviewItem.appendChild(questionText);

                q.options.forEach((option, optionIndex) => {
                    const optionDiv = document.createElement('div');
                    optionDiv.className = 'quiz-review-option';
                    
                    const isCorrect = optionIndex === q.correct;
                    const isUserAnswer = userAnswers[index] === optionIndex;

                    // Apply green for correct answer
                    if (isCorrect) {
                        optionDiv.classList.add('correct');
                        optionDiv.innerHTML = `✅ ${option}`;
                    } 
                    // Apply red for incorrect user answer
                    else if (isUserAnswer) {
                        optionDiv.classList.add('incorrect');
                        optionDiv.innerHTML = `❌ ${option}`;
                    }
                    // Default styling for other options
                    else {
                        optionDiv.innerHTML = `${String.fromCharCode(65 + optionIndex)}. ${option}`;
                    }
                    
                    questionReviewItem.appendChild(optionDiv);
                });
                
                fullQuizReview.appendChild(questionReviewItem);
            });
        }

        // Function to submit the quiz and display results
        function submitQuiz() {
            clearInterval(timerInterval); // Stop the timer
            
            // Check if the final question is answered
            const selected = document.querySelector(`input[name="question-${currentQuestionIndex}"]:checked`);
            if (!selected) {
                showModal("Please select an option before submitting.");
                return;
            }
            userAnswers[currentQuestionIndex] = parseInt(selected.value);

            // Disable all radio buttons and buttons after submission
            const allRadios = quizForm.querySelectorAll('input[type="radio"]');
            allRadios.forEach(radio => radio.disabled = true);

            let score = 0;
            allQuestions.forEach((q, index) => {
                if (userAnswers[index] === q.correct) {
                    score++;
                }
            });

            // Display results
            userNameResult.textContent = `Quiz Taker: ${userName}`;
            document.getElementById('total-questions').textContent = allQuestions.length;
            document.getElementById('obtained-marks').textContent = score;
            
            // Render the full quiz review
            renderFullResults();

            // Hide quiz, show results container
            quizContentWrapper.classList.add('hidden');
            resultsContainer.classList.remove('hidden');
            resultsContainer.scrollBy.scrollIntoView({ behavior: 'smooth' });
        }
        
        // Event listeners
        document.addEventListener('DOMContentLoaded', () => {
            // Show the name entry screen by default
            nameEntryContainer.classList.remove('hidden');
        });
        
        startBtn.addEventListener('click', startQuiz);
        
        modalCloseBtn.addEventListener('click', () => {
            modal.classList.add('hidden');
            modal.classList.remove('active');
        });
        
        // Event listener for the "Print Result" button
        printBtn.addEventListener('click', () => {
            window.print();
        });
        
        // Event listener for the "Download Result Card" button
        downloadBtn.addEventListener('click', () => {
            const headerContent = document.getElementById('header').innerHTML;
            const footerContent = document.getElementById('footer').innerHTML;
            const userName = document.getElementById('user-name-result').textContent;
            const totalQuestions = document.getElementById('total-questions').textContent;
            const obtainedMarks = document.getElementById('obtained-marks').textContent;

            // Create a temporary, hidden container for the image generation
            const tempContainer = document.createElement('div');
            tempContainer.id = 'download-result-container';
            document.body.appendChild(tempContainer);

            // Get current date and time
            const now = new Date();
            const dateStr = `${String(now.getDate()).padStart(2, '0')}/${String(now.getMonth() + 1).padStart(2, '0')}/${now.getFullYear()}`;
            const timeStr = `${String(now.getHours()).padStart(2, '0')}:${String(now.getMinutes()).padStart(2, '0')}:${String(now.getSeconds()).padStart(2, '0')}`;
            
            // Build the simplified content for the image
            tempContainer.innerHTML = `
                <div class="header-clone">${headerContent}</div>
                <div class="results-clone">
                    <h2 class="text-3xl font-extrabold text-center mb-4 text-green-700">Quiz Results</h2>
                    <p class="text-lg mb-1 text-center font-bold text-gray-700">Computer/IT MCQs For Unit 1</p>
                    <p class="text-lg mb-3 text-center font-extrabold text-green-600">${userName}</p>
                    <p class="text-lg text-gray-700 mt-4 text-center">Date: ${dateStr} - Time: ${timeStr}</p>
                    <p class="text-lg mb-3 text-center">
                        Total Questions: <span class="font-extrabold text-green-600">${totalQuestions}</span>
                    </p>
                    <p class="text-lg mb-6 text-center">
                        Obtained Marks: <span class="font-extrabold text-green-600">${obtainedMarks}</span>
                    </p>
                </div>
                <div class="footer-clone">${footerContent}</div>
            `;
            
            // Use html2canvas to capture the content of the temporary container
            html2canvas(tempContainer, {
                scale: 2, // Increase scale for a higher-quality image
                useCORS: true,
                backgroundColor: '#ffffff'
            }).then(canvas => {
                const image = canvas.toDataURL('image/png');
                const link = document.createElement('a');
                link.href = image;
                link.download = 'SST_Test_Result_Card.png';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            }).finally(() => {
                // Clean up the temporary container
                document.body.removeChild(tempContainer);
            });
        });
    </script>
</body>
</html>
